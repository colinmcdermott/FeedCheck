<!-- Tool by Colin McDermott / colin.mcdermott@news.co.uk / @ColinMcDermott -->
<!DOCTYPE html>
<html lang="en">
  <head>
	  <link rel="icon" type="image/svg" href="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' %3F%3E%3Csvg xmlns='http://www.w3.org/2000/svg' version='1.1' width='12' height='12'%3E%3C/svg%3E">
	  <meta charset="UTF-8">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	  <meta http-equiv="X-UA-Compatible" content="ie=edge">
	  <title>Feed Check Tool - The Times Tech SEO Team</title>
	  <style>
		html,body,main {
			content-visibility:visible;
			contain-intrinsic-size: 0 500px;
			text-rendering: optimizeSpeed;
		}
		:root {
			--flowSpace: 1.09em;
		}
		body {background-color:#e9e9e9;}
		body, input, label {
			font: 400 normal 18px/24px -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,sans-serif;
		}
		main, aside, form {
			padding: var(--flowSpace);
		}
		form {
			display: inline-flex;
			background-color: #F9F9F9;
			align-content: space-around;
			flex-wrap: wrap;
			align-items: center;
			min-height:75px;
		}
		label {font-weight:600;}
		input, label {
			margin: var(--flowSpace);
		}
		input[type=url] {
			min-height:30px;
		  }
		input[type=submit] {
			background-color: black;
			color: white;
			padding: 4px 8px;
			opacity:0.9;
		}
		input[type=submit]:hover {
			opacity:1
		}
		aside {
			display: inline-block;
		}
		summary, details {
			margin-bottom: var(--flowSpace);
		}
		summary:hover {
			text-decoration:underline;
			cursor:pointer;
		}
		@media screen and (max-width: 650px) {
			:root {
			    --flowSpace: 0.7em;
			}
			body, input, label {
				font-size:16px;
				line-height:20px;
			}
			body {
				margin:0;
			}
			form {
				flex-direction: column;
				padding: 5px;
				margin-bottom:15px;
				align-items: flex-start;
				align-content: flex-start;
				width:100%;
			}
			main {
				padding:0;
			}
		  }
	</style>
	<meta name="robots" content="noindex,nofollow">
  </head>
  <body>
	<main>
		<form class='feedCheckForm'>
			  <label for='hubURL'>RSS Feed URL:</label>
			  <input 
				type='url' 
				name='hub.url' 
				placeholder='https://example.com/feed/'
				pattern='https://.*' size='38'
				id='hubURL'
				required>
			  <input type='submit' value='Submit' id='submit' />
		</form> 
		<results id="results">
		</results>
	</main>

	<script>

/* Do not refresh the page when the submit button is clicked. When the 'submit' input is clicked on the form with class='feedCheckForm', take the value of id='hubURL', set this as variable 'hubURL', then print the value of 'hubURL' inside paragraph tags in the id=results element with the label  'Feed URL:'. Use the native Javascript Fetch API to fetch the RSS feed at the location of the 'hubURL' variable with a CORS cross-origin header, then print the size of the returned RSS feed inside a paragraph tag in the id='results' element with the label 'Response size:'. Repeat the fetch every 30 seconds, and print 'Fetch repeated' inside a paragraph tag in the id='results' element. Stop after 5 fetches. */
var hubURL;
var fetchCount = 0;
var fetchInterval = setInterval(function() {
  fetch(hubURL, {
    mode: 'cors'
  }).then(function(response) {
    return response.text();
  }).then(function(text) {
    var results = document.getElementById('results');
    var responseSize = document.createElement('p');
    responseSize.innerHTML = 'Response size: ' + text.length;
    results.appendChild(responseSize);
    fetchCount++;
    if (fetchCount >= 5) {
      clearInterval(fetchInterval);
    }
  });
}, 30000);
document.getElementsByClassName('feedCheckForm')[0].addEventListener('submit', function(event) {
  event.preventDefault();
  hubURL = document.getElementById('hubURL').value;
  var results = document.getElementById('results');
  var feedURL = document.createElement('p');
  feedURL.innerHTML = 'Feed URL: ' + hubURL;
  results.appendChild(feedURL);
});
		
	</script>
  </body>
</html>
